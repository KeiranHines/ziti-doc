---
title: Transplant a Controller Configuration
sidebar_label: Transplant
---

You can bring your own PKI, configuration, database, or all three by selectively disabling the respective `ZITI_BOOTSTRAP_*` environment variables in `/lib/systemd/system/ziti-controller.service` and running `sudo systemctl daemon-reload` before starting the service.

You can generate a configuration with the `ziti create config controller` command, optionally mutating the result through command-line options or environment variables. You can also find an annotated sample config file from [the Ziti repo](https://github.com/openziti/ziti/blob/main/etc/ctrl.with.edge.yml).

Here's an example BASH script for migrating an existing controller state to the Linux service's working directory.

```bash
#!/bin/bash

set -o errexit
set -o nounset
set -o pipefail
set -o xtrace

pushd $(mktemp -d)

# install controller and CLI packages
curl -sS https://get.openziti.io/install.bash \
| sudo bash -s openziti-controller

# create state with the quickstart
timeout 10s ziti edge quickstart --home $PWD

# ensure service is disabled and state is clean
sudo systemctl disable --now ziti-controller.service
sudo systemctl clean --what=state ziti-controller.service

# duplicate the controller part of the quickstart state to the service working directory using the config.yml filename
# expected by the controller service
sudo mkdir -pv /var/lib/ziti-controller/
sudo cp -Rv ./pki ./db /var/lib/ziti-controller/
sudo cp -v ./ctrl.yaml /var/lib/ziti-controller/config.yml

# correct config paths
sudo sed -Ei "s|$PWD|/var/lib/ziti-controller|g" /var/lib/ziti-controller/config.yml

# disable bootstrapping
sudo sed -Ei 's|(ZITI_BOOTSTRAP_.*)=.*|\1=false|g' /lib/systemd/system/ziti-controller.service
sudo systemctl daemon-reload

# start the service
sudo systemctl enable --now ziti-controller.service
sudo systemctl status ziti-controller.service

```

